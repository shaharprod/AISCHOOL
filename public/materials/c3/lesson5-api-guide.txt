××“×¨×™×š ×‘× ×™×™×ª API ×¢× Node.js ×•-Express
======================================

×©×™×¢×•×¨ 5: ×‘× ×™×™×ª API
===================

××‘×•×
====

×‘×©×™×¢×•×¨ ×–×” × ×œ××“ ×›×™×¦×“ ×œ×‘× ×•×ª API backend
×¢× Node.js ×•-Express ×‘-Project IDX.

×”×§××ª ×¤×¨×•×™×§×˜
============

1. ×¦×•×¨ ×¤×¨×•×™×§×˜ ×—×“×©
2. ×¤×ª×— Terminal
3. ×”×¨×¥:

```bash
npm init -y
npm install express
npm install -D nodemon
```

4. ×¦×•×¨ server.js:

```javascript
const express = require('express');
const app = express();
const PORT = 3000;

app.use(express.json());

app.get('/', (req, res) => {
  res.json({ message: 'Hello World' });
});

app.listen(PORT, () => {
  console.log(`Server running on port ${PORT}`);
});
```

5. ×”×•×¡×£ ×œ-package.json:

```json
{
  "scripts": {
    "start": "node server.js",
    "dev": "nodemon server.js"
  }
}
```

6. ×”×¨×¥:

```bash
npm run dev
```

Routes ×‘×¡×™×¡×™×™×
===============

GET Request:
------------

```javascript
app.get('/api/users', (req, res) => {
  res.json([
    { id: 1, name: 'John' },
    { id: 2, name: 'Jane' }
  ]);
});
```

POST Request:
-------------

```javascript
app.post('/api/users', (req, res) => {
  const { name, email } = req.body;
  
  // ×›××Ÿ ×ª×•×¡×™×£ ×œ×•×’×™×§×” ×œ×©××™×¨×”
  
  res.status(201).json({
    id: Date.now(),
    name,
    email
  });
});
```

PUT Request:
------------

```javascript
app.put('/api/users/:id', (req, res) => {
  const { id } = req.params;
  const { name, email } = req.body;
  
  // ×›××Ÿ ×ª×•×¡×™×£ ×œ×•×’×™×§×” ×œ×¢×“×›×•×Ÿ
  
  res.json({
    id,
    name,
    email
  });
});
```

DELETE Request:
---------------

```javascript
app.delete('/api/users/:id', (req, res) => {
  const { id } = req.params;
  
  // ×›××Ÿ ×ª×•×¡×™×£ ×œ×•×’×™×§×” ×œ××—×™×§×”
  
  res.status(204).send();
});
```

Middleware
==========

1. Body Parser:
--------------

```javascript
app.use(express.json());
app.use(express.urlencoded({ extended: true }));
```

2. CORS:
--------

```bash
npm install cors
```

```javascript
const cors = require('cors');
app.use(cors());
```

3. Custom Middleware:
--------------------

```javascript
const logger = (req, res, next) => {
  console.log(`${req.method} ${req.path}`);
  next();
};

app.use(logger);
```

4. Error Handling:
-----------------

```javascript
app.use((err, req, res, next) => {
  console.error(err.stack);
  res.status(500).json({ error: 'Something went wrong!' });
});
```

Routes ××•×ª×××™×
==============

×™×¦×™×¨×ª Router:

```javascript
// routes/users.js
const express = require('express');
const router = express.Router();

router.get('/', (req, res) => {
  res.json({ message: 'Get all users' });
});

router.get('/:id', (req, res) => {
  res.json({ message: `Get user ${req.params.id}` });
});

module.exports = router;

// server.js
const usersRouter = require('./routes/users');
app.use('/api/users', usersRouter);
```

×¢×‘×•×“×” ×¢× Database
==================

×¢× JSON File:
-------------

```javascript
const fs = require('fs');
const path = require('path');

const dataPath = path.join(__dirname, 'data.json');

function readData() {
  const data = fs.readFileSync(dataPath, 'utf8');
  return JSON.parse(data);
}

function writeData(data) {
  fs.writeFileSync(dataPath, JSON.stringify(data, null, 2));
}

// ×©×™××•×©:
app.get('/api/users', (req, res) => {
  const data = readData();
  res.json(data.users);
});
```

×¢× MongoDB:
-----------

```bash
npm install mongoose
```

```javascript
const mongoose = require('mongoose');

mongoose.connect('mongodb://localhost:27017/myapp');

const UserSchema = new mongoose.Schema({
  name: String,
  email: String
});

const User = mongoose.model('User', UserSchema);

app.get('/api/users', async (req, res) => {
  const users = await User.find();
  res.json(users);
});
```

×¢× Firebase:
------------

```bash
npm install firebase-admin
```

```javascript
const admin = require('firebase-admin');
const serviceAccount = require('./serviceAccountKey.json');

admin.initializeApp({
  credential: admin.credential.cert(serviceAccount)
});

const db = admin.firestore();

app.get('/api/users', async (req, res) => {
  const snapshot = await db.collection('users').get();
  const users = snapshot.docs.map(doc => ({
    id: doc.id,
    ...doc.data()
  }));
  res.json(users);
});
```

Authentication
==============

×¢× JWT:
-------

```bash
npm install jsonwebtoken bcrypt
```

```javascript
const jwt = require('jsonwebtoken');
const bcrypt = require('bcrypt');

const SECRET = 'your-secret-key';

// Register
app.post('/api/register', async (req, res) => {
  const { email, password } = req.body;
  const hashedPassword = await bcrypt.hash(password, 10);
  
  // ×©××•×¨ ××©×ª××© ×‘-DB
  
  const token = jwt.sign({ email }, SECRET);
  res.json({ token });
});

// Login
app.post('/api/login', async (req, res) => {
  const { email, password } = req.body;
  
  // ×‘×“×•×§ ××©×ª××© ×‘-DB
  // const user = await findUser(email);
  // const valid = await bcrypt.compare(password, user.password);
  
  if (valid) {
    const token = jwt.sign({ email }, SECRET);
    res.json({ token });
  } else {
    res.status(401).json({ error: 'Invalid credentials' });
  }
});

// Middleware
const authenticate = (req, res, next) => {
  const token = req.headers.authorization?.split(' ')[1];
  
  if (!token) {
    return res.status(401).json({ error: 'No token' });
  }
  
  try {
    const decoded = jwt.verify(token, SECRET);
    req.user = decoded;
    next();
  } catch (err) {
    res.status(401).json({ error: 'Invalid token' });
  }
};

// Protected Route
app.get('/api/profile', authenticate, (req, res) => {
  res.json({ user: req.user });
});
```

Validation
==========

×¢× Joi:
--------

```bash
npm install joi
```

```javascript
const Joi = require('joi');

const userSchema = Joi.object({
  name: Joi.string().min(3).required(),
  email: Joi.string().email().required(),
  password: Joi.string().min(6).required()
});

app.post('/api/users', (req, res) => {
  const { error, value } = userSchema.validate(req.body);
  
  if (error) {
    return res.status(400).json({ error: error.details[0].message });
  }
  
  // ×”××©×š ×¢× value ×”×××•××ª
});
```

Testing
=======

×¢× Jest:
--------

```bash
npm install -D jest supertest
```

```javascript
// __tests__/api.test.js
const request = require('supertest');
const app = require('../server');

describe('GET /api/users', () => {
  test('should return users', async () => {
    const response = await request(app).get('/api/users');
    expect(response.statusCode).toBe(200);
    expect(response.body).toBeInstanceOf(Array);
  });
});
```

×¡×™×›×•×
======

×¢×›×©×™×• ××ª×” ×™×•×“×¢:
âœ“ ××™×š ×œ×”×§×™× API
âœ“ ××™×š ×œ×™×¦×•×¨ Routes
âœ“ ××™×š ×œ×”×©×ª××© ×‘-Middleware
âœ“ ××™×š ×œ×¢×‘×•×“ ×¢× Database
âœ“ ××™×š ×œ×”×•×¡×™×£ Authentication

×‘×©×™×¢×•×¨ ×”×‘× × ×œ××“:
â†’ ×¤×¨×™×¡×” ×œ-Firebase
â†’ Firebase Hosting

××•×›× ×™× ×œ×”××©×™×š? ğŸš€

---
Â© 2026 Google AI Academy
××“×¨×™×š ×‘× ×™×™×ª API
×’×¨×¡×” 1.0
