דוגמאות Workflows - GitHub Actions
====================================

שיעור 11: דוגמאות Workflows מוסברות
=====================================

מבוא
====
Workflows ב-GitHub Actions הם תהליכים אוטומטיים שרצים על דחיפה (push) או על pull request. כל דוגמה כאן מוסברת – מה היא עושה, מה כל שלב, ומתי להשתמש.

Workflow 1: Test & Build
=========================

מה זה עושה?
------------
Workflow זה רץ בכל push או pull request. הוא מריץ בדיקות (tests) ובניית הפרויקט (build). אם הבדיקות נכשלות או ה-build נכשל – GitHub יציג כישלון ויחסום merge אם תרצה.

איך זה עובד?
-------------
• on: [push, pull_request] – ה-workflow מופעל בכל דחיפה או פתיחת/עדכון PR.
• jobs: test – עבודה אחת בשם "test".
• runs-on: ubuntu-latest – רץ על שרת Linux וירטואלי של GitHub.
• steps:
  - checkout – מוריד את קוד הפרויקט ל-server.
  - setup-node – מתקין Node.js (לפרויקטים JavaScript/React).
  - npm install – מתקין תלויות.
  - npm test – מריץ את הבדיקות (Jest וכו').
  - npm run build – בונה את הפרויקט (וידוא שה-build עובר).

מתי להשתמש?
------------
✓ בכל פרויקט React/Node – כדי לוודא שכל commit עובר tests ו-build.
✓ לפני merge ל-main – כך קוד שבור לא נכנס.

טיפים:
------
• התאם את גרסת Node (למשל node-version: '20') ב-setup-node.
• אם יש env variables לבדיקות – הוסף ב-GitHub Secrets והשתמש ב-env.

```yaml
name: Test and Build

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
      - run: npm install
      - run: npm test
      - run: npm run build
```

Workflow 2: Deploy ל-Firebase
==============================

מה זה עושה?
------------
Workflow זה רץ רק כשדוחפים ל-branch main. הוא בונה את הפרויקט ומעלה (deploy) ל-Firebase Hosting. כך כל עדכון ל-main מופיע אוטומטית באתר.

איך זה עובד?
-------------
• on: push / branches: [main] – רץ רק על push ל-main.
• steps: checkout, setup-node, install, build – כמו ב-Test & Build.
• Firebase deploy – משתמש ב-action FirebaseExtended/action-hosting-deploy. צריך להגדיר ב-GitHub Secrets:
  - FIREBASE_SERVICE_ACCOUNT – JSON של service account מ-Firebase.
  - projectId – מזהה הפרויקט ב-Firebase.

מתי להשתמש?
------------
✓ כשהאתר מאוחסן ב-Firebase Hosting ורוצים deploy אוטומטי מ-main.
✓ אחרי ש-Test & Build עוברים – מומלץ להריץ Deploy רק אחרי בדיקות (או לשלב ב-workflow אחד עם תנאי).

טיפים:
------
• אל תעלה את קובץ ה-service account ל-Git – רק ב-Secrets.
• בדוק ב-Firebase Console שה-Hosting מוגדר לפרויקט הנכון.

```yaml
name: Deploy

on:
  push:
    branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
      - run: npm install
      - run: npm run build
      - uses: FirebaseExtended/action-hosting-deploy@v0
        with:
          firebaseServiceAccount: '${{ secrets.FIREBASE_SERVICE_ACCOUNT }}'
          projectId: your-project-id
```

סיכום
======
• Test & Build – בדיקות ובנייה בכל push/PR.
• Deploy – העלאה ל-Firebase רק מ-main.
השתמש בהן כבסיס והתאם לפרויקט שלך (פקודות, secrets, branches).

---
© 2026 Google AI Academy
